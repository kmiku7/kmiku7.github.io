<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>kmiku7&#39;s blog</title>
  
    <meta name="robots" content="noindex, follow">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="kmiku7&#39;s blog">
<meta property="og:url" content="http://kmiku7.github.io/index.html">
<meta property="og:site_name" content="kmiku7&#39;s blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kmiku7&#39;s blog">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  <!--link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"-->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-27155459-3', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">kmiku7&#39;s blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">JUST DO IT.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://kmiku7.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-rosmaster-code-reading" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/22/rosmaster-code-reading/" class="article-date">
  <time datetime="2018-02-22T09:01:22.000Z" itemprop="datePublished">Feb 22 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ros/">ros</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/22/rosmaster-code-reading/">rosmaster code reading</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h1><ul>
<li><a href="http://wiki.ros.org/rosmaster" target="_blank" rel="noopener">wiki</a></li>
<li><a href="https://docs.python.org/2/library/simplexmlrpcserver.html#SimpleXMLRPCServer.SimpleXMLRPCServer.register_instance" target="_blank" rel="noopener">Python2 SimpleXMLRPCServer manual</a><br>register_instane()注册实例中不以下划线开头，并且callable的对象。</li>
</ul>
<h1 id="代码路径入口"><a href="#代码路径入口" class="headerlink" title="代码路径入口"></a>代码路径入口</h1><ul>
<li>rosmaster command<br><code>ros_comm/tools/rosmaster/scripts/rosmaster</code></li>
<li>rosmaster logic entry<br><code>ros_comm/tools/rosmaster/src/rosmaster/main.py rosmaster_main()</code></li>
</ul>
<h1 id="implementation"><a href="#implementation" class="headerlink" title="implementation"></a>implementation</h1><p>核心逻辑入口在 Master class，是现在<code>ros_comm/tools/rosmaster/src/rosmaster/master.py</code>文件中。</p>
<p>启动流程为：</p>
<ol>
<li>启动传入参数解析</li>
<li>初始化 ROSMasterHandler</li>
<li>初始化 XmlRpcNode(server)，并启动</li>
<li>检查XmlRpcNode(server)状态，直到退出</li>
</ol>
<h2 id="ROSMasterHandler"><a href="#ROSMasterHandler" class="headerlink" title="ROSMasterHandler"></a>ROSMasterHandler</h2><p>最主要的业务逻辑都在这里，实现文件：<code>ros_comm/tools/rosmaster/src/rosmaster/master_api.py</code>。</p>
<h3 id="实现包含的方法、功能"><a href="#实现包含的方法、功能" class="headerlink" title="实现包含的方法、功能"></a>实现包含的方法、功能</h3><ol>
<li>EXTERNAL API<br> 1.1. <strong>shutdown</strong><br> Stop this server.<br> 1.2. <strong>getUri</strong><br> Get the XML-RPC URI of this server.<br> 通过xmlrpc server获取xmlrpc server的地址，有种先有鸡还是先有蛋的纠结。<br> 1.3. <strong>getPid</strong><br> Get the PID of this server.</li>
<li>PARAMETER SERVER ROUNTINES<br> 2.1. <strong>deleteParam</strong><br> 2.2. <strong>setParam</strong><br> 2.3. <strong>getParam</strong><br> 2.4. <strong>searchParam</strong><br> 2.5. <strong>subscribeParam</strong><br> 2.6. <strong>unsubscribeParam</strong><br> 2.7. <strong>hasParam</strong><br> 2.8. <strong>getParamNames</strong></li>
<li>NOTIFICATION ROUTINES<br> 3.1. <strong>param_update_task</strong></li>
<li>SERVICE PROVIDER<br> 4.1. <strong>registerService</strong><br> Register the caller as a provider of the specified service.<br> 4.2. <strong>lookupService</strong><br> 4.3. <strong>unregisterService</strong></li>
<li>PUBLISH/SUBSCRIBE<br> 5.1. <strong>registerSubscriber</strong><br> 5.2. <strong>unregisterSubscriber</strong><br> 5.3. <strong>registerPublisher</strong><br> 5.4. <strong>unregisterPublisher</strong></li>
<li>GRAPH STATE APIS<br> 6.1. <strong>lookupNode</strong><br> 6.2. <strong>getPublishedTopics</strong><br> 6.3. <strong>getTopicTypes</strong><br> 6.4. <strong>getSystemState</strong></li>
</ol>
<h3 id="核心逻辑"><a href="#核心逻辑" class="headerlink" title="核心逻辑"></a>核心逻辑</h3><ul>
<li>信息的存储检索</li>
<li>信息的订阅通知</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <!--a data-url="http://kmiku7.github.io/2018/02/22/rosmaster-code-reading/" data-id="cjdya7qkc000lm4s6n6svy382" class="article-share-link">Share</a-->
      
        <a href="http://kmiku7.github.io/2018/02/22/rosmaster-code-reading/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/code-analysis/">code-analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ros/">ros</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ros1/">ros1</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/roscore/">roscore</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/roslaunch/">roslaunch</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-roscore-code-reading" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/22/roscore-code-reading/" class="article-date">
  <time datetime="2018-02-22T08:59:46.000Z" itemprop="datePublished">Feb 22 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ros/">ros</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/22/roscore-code-reading/">roscore code reading</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong><em>代码版本：<br>/rosdistro: indigo<br>/rosversion: 1.11.21</em></strong></p>
<h1 id="参考资源链接"><a href="#参考资源链接" class="headerlink" title="参考资源链接"></a>参考资源链接</h1><ul>
<li><a href="http://wiki.ros.org/roscore" target="_blank" rel="noopener">roscore wiki</a></li>
<li><a href="http://blog.csdn.net/lewif/article/details/75112520" target="_blank" rel="noopener">ros源码分析(1)—roscore概况</a></li>
<li><a href="http://www.cnblogs.com/wanghaoran/p/3189017.html" target="_blank" rel="noopener">Python中关于XML-RPC原理</a></li>
</ul>
<h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><p>/opt/ros/indigo/etc/ros/roscore.xml<br>这里配置随roscore一起启动的node。</p>
<h1 id="启动的node-or-process"><a href="#启动的node-or-process" class="headerlink" title="启动的node or process"></a>启动的node or process</h1><ul>
<li>/rosout/rosout: a rosout logging node</li>
<li>ros master</li>
<li>ros parameter server</li>
<li>rosmaster</li>
<li>process monitor</li>
<li>parent xml-rpc server</li>
</ul>
<h1 id="roscore启动逻辑"><a href="#roscore启动逻辑" class="headerlink" title="roscore启动逻辑"></a>roscore启动逻辑</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ type roscore</span><br><span class="line">roscore is hashed (/opt/ros/indigo/bin/roscore)</span><br></pre></td></tr></table></figure>
<p>核心代码为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> roslaunch</span><br><span class="line">roslaunch.main([<span class="string">'roscore'</span>, <span class="string">'--core'</span>] + sys.argv[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure></p>
<p>这里传入的roscore没有作用，--core参数真正指定了启动roscore。配置文件名 roscore.xml 也是在代码中写死，根据版本号等信息拼接出来完整的配置文件路径。</p>
<p>如果没有预先执行roscore，我们用roslaunch *.launch 启动node也会自动roscore相关的进程组件。分析代码，可以把处理逻辑总结为：roslaunch启动 *.launch 文件中配置的node，启动前先检查环境，如果没有启动roscore则先启动，如果已经启动了，则判断命令行参数中有没有 --core，如果有则报错，如果没有继续执行 *.launch 中的操作。</p>
<p>roslaunch command demo:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ roslaunch package_name file.launch</span><br></pre></td></tr></table></figure></p>
<h1 id="roslaunch-启动逻辑"><a href="#roslaunch-启动逻辑" class="headerlink" title="roslaunch 启动逻辑"></a>roslaunch 启动逻辑</h1><p>核心代码逻辑位于 <code>ros_comm/tools/roslaunch/src/roslaunch/parent.py ROSLaunchParent::start()</code>。</p>
<h2 id="start-infrastructure"><a href="#start-infrastructure" class="headerlink" title="start infrastructure"></a>start infrastructure</h2><h3 id="load-ros-launch-file"><a href="#load-ros-launch-file" class="headerlink" title="load ros launch file"></a>load ros launch file</h3><p>代码文件 <code>ros_comm/tools/roslaunch/src/roslaunch/config.py</code>。</p>
<p>首先加载 roscore.xml 文件，然后加载命令行中执行的 launch file。参考代码注释：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># load the roscore file first. we currently have</span><br><span class="line"># last-declaration wins rules.  roscore is just a</span><br><span class="line"># roslaunch file with special load semantics</span><br></pre></td></tr></table></figure></p>
<h3 id="start-process-monitor"><a href="#start-process-monitor" class="headerlink" title="start process monitor"></a>start process monitor</h3><p>代码文件 <code>ros_comm/tools/roslaunch/src/roslaunch/pmon.py</code>。</p>
<p><code>ProcessMonitor</code> 是一个继承自<code>Python::Thread</code>的类。其中另一个类<code>Process</code> 代表launch启动的一个进程，封装了进程的一些启动参数，是否是关键节点，如果异常退出是否重启等信息。然后将 Process instance 注册到 ProcessMonitor instance 进行监控。</p>
<h3 id="start-roslaunch-runner-and-XMLRPC-server"><a href="#start-roslaunch-runner-and-XMLRPC-server" class="headerlink" title="start roslaunch runner and XMLRPC server"></a>start roslaunch runner and XMLRPC server</h3><p>代码文件 <code>ros_comm/tools/roslaunch/src/roslaunch/server.py</code>。</p>
<p>这里启动了一个xmlrpc server，实现在class ROSLaunchParentNode，并注册了一些方法。启动后立即创建一个client去连接server，确认启动成功。</p>
<h2 id="initialize-the-actual-runner-and-launch"><a href="#initialize-the-actual-runner-and-launch" class="headerlink" title="initialize the actual runner and launch"></a>initialize the actual runner and launch</h2><p>代码文件 <code>ros_comm/tools/roslaunch/src/roslaunch/launch.py</code>。</p>
<p>这里创建一个ROSLaunchRunner instance，这个实例负责启动 launch file 中配置的node。在调用 <code>launch()</code> 启动时，会检测roscore环境是否启动，如果没有则启动：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_setup</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Setup the state of the ROS network, including the parameter</span></span><br><span class="line"><span class="string">    server state and core services</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    ...           </span><br><span class="line"></span><br><span class="line">    <span class="comment"># start up the core: master + core nodes defined in core.xml</span></span><br><span class="line">    <span class="comment"># 启动 ros master</span></span><br><span class="line">    self._launch_master()</span><br><span class="line">    <span class="comment"># 启动 roscore 包含的 nodes</span></span><br><span class="line">    self._launch_core_nodes()</span><br></pre></td></tr></table></figure></p>
<p>在启动时，XmlLoader对象用于解析launch file和roscore.xml，并对 core nodes 和 normal nodes分组管理，接口中有参数指定要解析的xml配置文件是否属于roscore的，由调用方负责传入，如果是，其中包含的nodes放入 core nodes中管理。<br>启动 core nodes 时，如果node已经存在，则跳过。启动 normal nodes 时，如果node已经存在，则杀死已存在的node，再启动新node。</p>
<p>ros master 则是通过<code>rosmaster --core ...</code>方式启动。</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><ul>
<li>roscore代表着启动整套基础环境。</li>
<li>parameter server并不是一个单独存在的Server，而是rosmaster的一部分。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <!--a data-url="http://kmiku7.github.io/2018/02/22/roscore-code-reading/" data-id="cjdya7qk7000jm4s6ozpwucto" class="article-share-link">Share</a-->
      
        <a href="http://kmiku7.github.io/2018/02/22/roscore-code-reading/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/code-analysis/">code-analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ros/">ros</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ros1/">ros1</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/roscore/">roscore</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/roslaunch/">roslaunch</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-request-processing-in-django" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/07/request-processing-in-django/" class="article-date">
  <time datetime="2018-02-07T07:51:44.000Z" itemprop="datePublished">Feb 7 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/07/request-processing-in-django/">request processing in Django</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近有个需求，提供一个http代理，提供后端分布式文件存储系统的下载、上传两个功能，文件大小极限值在100GB+。考虑到其他一些限制，最终选择使用 Nginx + uWSGI + Django的方案。</p>
<p>这里仅仅是记录了开发过程中对Django默认配置下，WSGIHandler处理http请求过程的分析。重点关注了请求数据、返回数据的解析、处理过程。因为要避免大量数据载入内存导致异常，以及大量数据落盘导致的开销。<br>文章中的代码片段并没有遵守python语法，为了描述的简洁混杂了c++的语法。</p>
<p>django code version: 1.11.3</p>
<h1 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h1><p>默认构造一个WSGIRequest对象。<a href="http://kmiku7.github.io/2018/02/07/difference-between-manage-py-runserver-and-uswgi/">ref</a><br>解析请求参数过程使用了lazy loading方式，GET &amp; POST字段都是property。<br>GET是每次都解析 <code>self.environ[‘QUERY_STRING’]</code> 参数。<br>POST或FILES是其中一个首次使用时（即_post, _files字段为空），调用父类的 <code>_load_post_and_files()</code> 函数，该函数解析post方式的数据，并设置 _post, _files 两个字段，此时POST &amp; FILES都处于直接可用的状态。</p>
<h3 id="load-post-and-files-函数分析"><a href="#load-post-and-files-函数分析" class="headerlink" title="_load_post_and_files() 函数分析"></a>_load_post_and_files() 函数分析</h3><p>忽略异常判断逻辑。<br>代码只支持 &#39;multipart/form-data&#39; &amp; &#39;application/x-www-form-urlencoded&#39; 两种POST数据编码方式。使用其他方式不会报错，仅仅是 POST &amp; FILES 为空。<br>根据<code>WSGIRequest::__init__()</code>，post entity-body数据流保存在_stream字段，并未读取。</p>
<h4 id="39-application-x-www-form-urlencoded-39-数据解析"><a href="#39-application-x-www-form-urlencoded-39-数据解析" class="headerlink" title="&#39;application/x-www-form-urlencoded&#39; 数据解析"></a>&#39;application/x-www-form-urlencoded&#39; 数据解析</h4><p>一次性读取出所有的entity-body数据，并赋值给_body字段，然后解码。<br>这种方式是只能传递form参数，不能上传文件。<br>同时这种方式可以通过 <code>settings.DATA_UPLOAD_MAX_MEMORY_SIZE</code> 设置数据大小上限。</p>
<h4 id="39-multipart-form-data-39-数据解析"><a href="#39-multipart-form-data-39-数据解析" class="headerlink" title="&#39;multipart/form-data&#39; 数据解析"></a>&#39;multipart/form-data&#39; 数据解析</h4><p>首先判断数据源，如果有_body字段则使用该字段的数据，并封装出来readable object，即有read()函数。<br>如果没有则使用self，self提供了read()函数读取self._stream数据。<br>然后使用 <code>parse_file_upload()</code> 函数解析数据，该函数同时解析出来 POST &amp; FILES参数，不要被函数名误导。该函数使用<code>django.http.multipartparser.MultiPartParser</code>类解析。</p>
<p>此处上传数据有两种：请求字段，文件。<br>对于上传的普通字段，可以通过 <code>settings.DATA_UPLOAD_MAX_NUMBER_FIELDS</code> 限制上传的字段个数，不包含文件个数，以及通过 <code>settings.DATA_UPLOAD_MAX_MEMORY_SIZE</code> 限制字段值长度和的上限，不包括文件大小。</p>
<p>对于上传的文件，<code>MultiPartParser class</code>本身没有具体的逻辑，而是提供了一套处理机制，由提供的实现 <code>class FileUploadHandler</code> 的类完成处理。可以提供多个handler，通过参数 <code>settings.FILE_UPLOAD_HANDLERS</code> 配置，有默认值，参考文档：<a href="https://docs.djangoproject.com/en/1.11/topics/http/file-uploads/#upload-handlers" target="_blank" rel="noopener">link</a>。这些handler会对每一个Request初始化一次，然后使用同一个handler instance处理request内所有的文件上传信息，根据代码Django遵循了POST数据内每一个 form field or file chunk 都是顺序连续出现的，不会有交叉。<br>MultiPartParser循环读取上传文件的每个chunk，然后循环调用每个handlers处理当前chunk。每个handlers最后返回一个Filelike object，因此理论上上传一个文件，server端会产生len(handlers)个文件对象，但是我们通过FILES[FILENAME]只会返回一个object，这是因为FILES是 <code>django.utils.datastructures.MultiValueDict</code> 类型，接口类似dict，但是逻辑不同，参考代码：<a href="https://docs.djangoproject.com/en/1.11/_modules/django/utils/datastructures/" target="_blank" rel="noopener">link</a>。<br>GET &amp; POST 类型为 <code>class QueryDict(MultiValueDict)</code>，集成增加了 mutable 开关。</p>
<p>看到这里我们知道file upload handler的设置是全局的，如果想针对某个接口做定制化的配置并不能直接达到目的。那么如果在业务代码收到request object时设置 <code>http.HttpRequest::upload_handlers</code> 字段也是可以的，只要代码中的middlewares，或其他部分没有使用过POST或FILES参数。<br>在某一个时间点上是可以做到的，但是随着项目迭代这种约定很容易被破坏。</p>
<p>参考链接：</p>
<ol>
<li><a href="https://docs.djangoproject.com/en/1.11/topics/http/file-uploads/#id1" target="_blank" rel="noopener">Django 1.11 Doc: Modifying upload handlers on the fly</a></li>
<li><a href="https://docs.djangoproject.com/en/1.11/ref/files/uploads/#writing-custom-upload-handlers" target="_blank" rel="noopener">Django 1.11 Doc: Writing custom upload handlers</a></li>
</ol>
<h1 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h1><p>接下来通过<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response = WSGIHandler::BaseHandler.get_response(request)</span><br></pre></td></tr></table></figure></p>
<p>进入处理流程。</p>
<p>get_response() 主要逻辑就是调用 middleware_chain。<code>settings.MIDDLEWARE</code> 是按顺序执行的，不要被初始化时的 <code>reversed(settings.MIDDLEWARE)</code> 操作混淆。<br>初始化middleware_chain时首先会插入 <code>BaseHandler::_get_response()</code>， 该函数在调用链中最后执行，也就是在该函数里走入url dispatch逻辑，并获取业务代码产生的response object。</p>
<p><code>settings.ROOT_URLCONF</code> 配置了 url dispatch patterns。</p>
<h1 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h1><h2 id="python-manage-py-runserver-方式启动"><a href="#python-manage-py-runserver-方式启动" class="headerlink" title="python manage.py runserver 方式启动"></a>python manage.py runserver 方式启动</h2><p>server实现为 <code>django.core.servers.basehttp.WSGIServer</code> 类，该类继承自python标准库的类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsgiref.simple_server.WSGIServer(server_address, RequestHandlerClass)</span><br></pre></td></tr></table></figure></p>
<p>manual: <a href="https://docs.python.org/3.6/library/wsgiref.html?highlight=simple_server#wsgiref.simple_server.WSGIServer" target="_blank" rel="noopener">link</a></p>
<p>处理逻辑入口为RequestHandlerClass::handle()函数，Django的继承实现类为 <code>django.core.servers.basehttp.WSGIRequestHandler</code>。</p>
<p>处理框架在 <code>class wsgiref.handlers.BaesHandler</code> 里：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseHandler</span>:</span></span><br><span class="line">    <span class="string">"""Manage the invocation of a WSGI application"""</span></span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, application)</span>:</span></span><br><span class="line">        <span class="string">"""Invoke the application"""</span></span><br><span class="line">        <span class="comment"># Note to self: don't move the close()!  Asynchronous servers shouldn't</span></span><br><span class="line">        <span class="comment"># call close() from finish_response(), so if you close() anywhere but</span></span><br><span class="line">        <span class="comment"># the double-error branch here, you'll break asynchronous servers by</span></span><br><span class="line">        <span class="comment"># prematurely closing.  Async servers must return from 'run()' without</span></span><br><span class="line">        <span class="comment"># closing if there might still be output to iterate over.</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.setup_environ()</span><br><span class="line">            self.result = application(self.environ, self.start_response)</span><br><span class="line">            self.finish_response()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.handle_error()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># If we get an error handling an error, just give up already!</span></span><br><span class="line">                self.close()</span><br><span class="line">                <span class="keyword">raise</span>   <span class="comment"># ...and let the actual server figure it out.</span></span><br><span class="line">                </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">finish_response</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Send any iterable data, then close self and the iterable</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Subclasses intended for use in asynchronous servers will</span></span><br><span class="line"><span class="string">        want to redefine this method, such that it sets up callbacks</span></span><br><span class="line"><span class="string">        in the event loop to iterate over the data, and to call</span></span><br><span class="line"><span class="string">        'self.close()' once the response is finished.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.result_is_file() <span class="keyword">or</span> <span class="keyword">not</span> self.sendfile():</span><br><span class="line">                <span class="keyword">for</span> data <span class="keyword">in</span> self.result:</span><br><span class="line">                    self.write(data)</span><br><span class="line">                self.finish_content()</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            self.close()</span><br></pre></td></tr></table></figure></p>
<p>self.result 即Django框架返回的 response object，必须是一个generator，可以迭代。<br>Django response有 stream HTTP response &amp; normal HTTP response 两种返回值，在内部已经统一封装成Iterator，对外无区别。</p>
<h2 id="uWSGI-方式启动"><a href="#uWSGI-方式启动" class="headerlink" title="uWSGI 方式启动"></a>uWSGI 方式启动</h2><p><em>todo</em></p>

      
    </div>
    <footer class="article-footer">
      <!--a data-url="http://kmiku7.github.io/2018/02/07/request-processing-in-django/" data-id="cjdya7qkf000rm4s67wo0z7uo" class="article-share-link">Share</a-->
      
        <a href="http://kmiku7.github.io/2018/02/07/request-processing-in-django/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zh/">zh</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-difference-between-manage-py-runserver-and-uswgi" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/07/difference-between-manage-py-runserver-and-uswgi/" class="article-date">
  <time datetime="2018-02-07T07:03:05.000Z" itemprop="datePublished">Feb 7 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/07/difference-between-manage-py-runserver-and-uswgi/">difference between &#39;manage.py runserver&#39; and uswgi</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="python-manage-py-runserver-启动方式"><a href="#python-manage-py-runserver-启动方式" class="headerlink" title="python manage.py runserver 启动方式"></a>python manage.py runserver 启动方式</h3><p>该命令执行的 django/core/management/commands/runserver.py 中的代码，通过调用链：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">execute()</span><br><span class="line">    -&gt; BaseCommand::execute()</span><br><span class="line">    -&gt; handle() </span><br><span class="line">    -&gt; run() </span><br><span class="line">    -&gt; inner_run() </span><br><span class="line">    -&gt; get_handler() </span><br><span class="line">    -&gt; django.core.servers.basehttp.get_internal_wsgi_application()</span><br></pre></td></tr></table></figure></p>
<p>获取一个 WSGI application object。</p>
<p>get_internal_wsgi_application() 默认调用 django.core.wsgi.get_wsgi_application()，该函数首先读取settings.WSGI_APPLICATION参数获取一个wsgi application object对象。</p>
<p>WSGI_APPLICATION参数设置方式参考：</p>
<blockquote>
<p>By default, it’s set to <project_name>.wsgi.application, which points to the application callable in <project_name>/wsgi.py.</project_name></project_name></p>
</blockquote>
<p>如果该参数没有设置，则调用 <strong>django.core.wsgi.get_wsgi_application()</strong>，返回django.core.handers.wsgi.WSGIHandler类的实例。</p>
<h3 id="使用uwsgi启动"><a href="#使用uwsgi启动" class="headerlink" title="使用uwsgi启动"></a>使用uwsgi启动</h3><p>当使用 django-admin startproject ProjectName 创建新app后，会生成 ProjectName/wsgi.py 文件，该文件默认也使用 <strong>django.core.wsgi.get_wsgi_application()</strong> 获取一个application object。 </p>
<p>refference:<br><a href="http://uwsgi-docs.readthedocs.io/en/latest/Python.html" target="_blank" rel="noopener">http://uwsgi-docs.readthedocs.io/en/latest/Python.html</a></p>
<p>因此二者默认情况下是一样的。但是个性化配置方式不同。</p>

      
    </div>
    <footer class="article-footer">
      <!--a data-url="http://kmiku7.github.io/2018/02/07/difference-between-manage-py-runserver-and-uswgi/" data-id="cjdya7qjv0009m4s68qhan7d7" class="article-share-link">Share</a-->
      
        <a href="http://kmiku7.github.io/2018/02/07/difference-between-manage-py-runserver-and-uswgi/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/uWSGI/">uWSGI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zh/">zh</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/02/Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error/" class="article-date">
  <time datetime="2018-02-02T04:05:15.000Z" itemprop="datePublished">Feb 2 2018</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/02/Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error/">Solve  &#39;uwsgi_response_write_body_do() TIMEOUT !!!&#39; error</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Recently I write a django service to produce very large data in response, about 10GB data per request or even larger sometimes.</p>
<p>When I use <code>python manage.py runserver</code> to test service, there is no problem. But when use nginx + uwsgi to support service, I can&#39;t get the complete response at the client side. At the same time, there is an error log in uwsgi.log and a regular log notice that uswgi has finished request processing:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Fri Feb  88 88:88:88 2088 - uwsgi_response_write_body_do() TIMEOUT !!!</span><br><span class="line">OSError: write error</span><br><span class="line">GET REQUEST-URL =&gt; generated 8888888888 bytes in 8888 msecs (HTTP/1.1 200) 8 headers in 888 bytes</span><br></pre></td></tr></table></figure></p>
<p>When uwsgi outputs these logs, the client still receives response data until the size of received equal to the generated size output in server log. And the generated size is smaller than the full size of response. So I think there is a large buffer in Nginx. Uwsgi writes response to Nginx actively and the speed is very fast because they are in same machine. But Nginx writes response to client is slow. If Nginx stores response data in buffer, uwsgi&#39;s write request will block when buffer is full. If buffer size is very large, uwsgi will wait a long time before Nginx clears its buffer and write request timeout.<br>Only in this way the Nginx can still write data to client when uwsgi finishs processing and close response stream.</p>
<p>According to <a href="http://nginx.org/en/docs/http/ngx_http_uwsgi_module.html#uwsgi_buffering" target="_blank" rel="noopener">ngx_http_uwsgi_module&#39;s document</a>:</p>
<blockquote>
<p>When buffering is enabled, nginx receives a response from the uwsgi server as soon as possible, saving it into the buffers set by the uwsgi_buffer_size and uwsgi_buffers directives. If the whole response does not fit into memory, a part of it can be saved to a temporary file on the disk. Writing to temporary files is controlled by the uwsgi_max_temp_file_size and uwsgi_temp_file_write_size directives.</p>
</blockquote>
<p>There are memory buffers and temporary file buffers. The default size of memory buffers is only a few kilobytes. But the default max size of temporary file buffers is 1024MB, which is approximately equal to the generated size in uwsgi log.</p>
<p><strong>In order to solve this problem, we can just disable temporary file buffers, use the directive <code>uwsgi_max_temp_file_size 0;</code>. </strong></p>
<p>A memory buffer of a few kilobytes is ok because it will not block uwsgi&#39; write request much time.<br>But as the previous analysis, if the transmission speed between Nginx and client side is far slower to the speed between Nginx and uswgi, the problem will come up no matter how smaller the buffer is.<br>As the implementation of Django and uwsgi, uwsgi read a block of data and write to response stream, if the block size is large enough and the transmission speed to the client side is slow enough, the problem will come up even all buffers in Nginx disabled. Because the block can be considered as a different form of buffer.</p>
<p>So slower transmission speed to client side means the smaller size of buffer we can use.<br>And we don&#39;t know user&#39;s network conditions, what we can do is only disable buffers.</p>

      
    </div>
    <footer class="article-footer">
      <!--a data-url="http://kmiku7.github.io/2018/02/02/Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error/" data-id="cjdya7qje0000m4s6vuu7adhg" class="article-share-link">Share</a-->
      
        <a href="http://kmiku7.github.io/2018/02/02/Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/en/">en</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/uWSGI/">uWSGI</a></li></ul>

    </footer>
  </div>
  
</article>



  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cpp/">cpp</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/interview/">interview</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ros/">ros</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ac-search/">ac-search</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/avl-tree/">avl-tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/b-tree/">b-tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clrs/">clrs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/code-analysis/">code-analysis</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codis/">codis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/">cpp</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-structure/">data-structure</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/">debug</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/en/">en</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gorun/">gorun</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/libchan/">libchan</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/list/">list</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/merge-sort/">merge-sort</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/morris-travesal/">morris-travesal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxy/">proxy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ros/">ros</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ros1/">ros1</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/roscore/">roscore</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/roslaunch/">roslaunch</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/">sort</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stl/">stl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/string-match/">string-match</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/">thread</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/threaded-binary-tree/">threaded-binary-tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/threading/">threading</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tree/">tree</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trie/">trie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uWSGI/">uWSGI</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zh/">zh</a><span class="tag-list-count">11</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Django/" style="font-size: 11.67px;">Django</a> <a href="/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/ac-search/" style="font-size: 10px;">ac-search</a> <a href="/tags/algorithm/" style="font-size: 13.33px;">algorithm</a> <a href="/tags/avl-tree/" style="font-size: 10px;">avl-tree</a> <a href="/tags/b-tree/" style="font-size: 10px;">b-tree</a> <a href="/tags/clrs/" style="font-size: 10px;">clrs</a> <a href="/tags/code-analysis/" style="font-size: 18.33px;">code-analysis</a> <a href="/tags/codis/" style="font-size: 10px;">codis</a> <a href="/tags/cpp/" style="font-size: 16.67px;">cpp</a> <a href="/tags/data-structure/" style="font-size: 13.33px;">data-structure</a> <a href="/tags/debug/" style="font-size: 10px;">debug</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/en/" style="font-size: 10px;">en</a> <a href="/tags/golang/" style="font-size: 13.33px;">golang</a> <a href="/tags/gorun/" style="font-size: 10px;">gorun</a> <a href="/tags/leetcode/" style="font-size: 13.33px;">leetcode</a> <a href="/tags/libchan/" style="font-size: 10px;">libchan</a> <a href="/tags/list/" style="font-size: 10px;">list</a> <a href="/tags/merge-sort/" style="font-size: 10px;">merge-sort</a> <a href="/tags/morris-travesal/" style="font-size: 10px;">morris-travesal</a> <a href="/tags/proxy/" style="font-size: 10px;">proxy</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/ros/" style="font-size: 11.67px;">ros</a> <a href="/tags/ros1/" style="font-size: 11.67px;">ros1</a> <a href="/tags/roscore/" style="font-size: 11.67px;">roscore</a> <a href="/tags/roslaunch/" style="font-size: 11.67px;">roslaunch</a> <a href="/tags/sort/" style="font-size: 10px;">sort</a> <a href="/tags/stl/" style="font-size: 10px;">stl</a> <a href="/tags/string-match/" style="font-size: 10px;">string-match</a> <a href="/tags/thread/" style="font-size: 10px;">thread</a> <a href="/tags/threaded-binary-tree/" style="font-size: 10px;">threaded-binary-tree</a> <a href="/tags/threading/" style="font-size: 10px;">threading</a> <a href="/tags/tree/" style="font-size: 13.33px;">tree</a> <a href="/tags/trie/" style="font-size: 10px;">trie</a> <a href="/tags/uWSGI/" style="font-size: 11.67px;">uWSGI</a> <a href="/tags/zh/" style="font-size: 20px;">zh</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/02/22/rosmaster-code-reading/">rosmaster code reading</a>
          </li>
        
          <li>
            <a href="/2018/02/22/roscore-code-reading/">roscore code reading</a>
          </li>
        
          <li>
            <a href="/2018/02/07/request-processing-in-django/">request processing in Django</a>
          </li>
        
          <li>
            <a href="/2018/02/07/difference-between-manage-py-runserver-and-uswgi/">difference between &#39;manage.py runserver&#39; and uswgi</a>
          </li>
        
          <li>
            <a href="/2018/02/02/Solve-the-problem-of-uwsgi-uwsgi-response-write-body-do-TIMEOUT-error/">Solve  &#39;uwsgi_response_write_body_do() TIMEOUT !!!&#39; error</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 kmiku7<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/kmiku7/landscape-k" target="_blank">landscape-k</a>.
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'kmiku7';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>